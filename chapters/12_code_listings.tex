The following code contains pertinent examples of key R and SQL code used in this research

\section{An example of in-vehicle modelling using a mass-balance approach}
\label{code:in_vehicle_example}
\lstinputlisting[language=R, breaklines, breakautoindent, frame=lines, showspaces=false, showstringspaces=false]{code/in_vehicle_example.R}

\newpage
\section{Requesting a route using a bus from the TfL API}
\label{code:tfl_bus_request}
\lstinputlisting[language=R, breaklines, breakautoindent, frame=lines, showspaces=false, showstringspaces=false]{code/tfl_bus_request.R}

\newpage
\section{Creating the geographical missclassification graphs and maps}
\label{code:create_geographical_results}
\lstinputlisting[language=R, breaklines, breakautoindent, frame=lines, showspaces=false, showstringspaces=false]{code/create_geographical_results.R}

\newpage
\section{Creating a London Underground GIS file}
\label{code:make_tube_network_from_scratch}
\lstinputlisting[language=SQL, breaklines, breakautoindent, frame=lines, showspaces=false, showstringspaces=false]{code/make_tube_network_from_scratch.sql}

\newpage
\section{Creating the central line map}
\label{code:fake_tube_map_central_line}
\lstinputlisting[language=R, breaklines, breakautoindent, frame=lines, showspaces=false, showstringspaces=false]{code/fake_tube_map_central_line.R}

\newpage
\section{Creating example distribution plots for the LHEM}
\label{code:example_distribution_plot}
\lstinputlisting[language=R, breaklines, breakautoindent, frame=lines, showspaces=false, showstringspaces=false]{code/example_correction_graph.R}

\newpage
\section{Creating August-September 9am air quality data}
\label{code:make_cmaq_aug_sept_file}
\lstinputlisting[language=R, breaklines, breakautoindent, frame=lines, showspaces=false, showstringspaces=false]{code/make_cmaq_aug_sept_file.R}



